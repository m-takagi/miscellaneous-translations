<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ops="http://www.idpf.org/2007/ops" xml:lang="ja">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <link rel="stylesheet" type="text/css" href="style.css" />
  <meta name="generator" content="ReVIEW" />
  <title>Backups to Maintain Sanity</title>
</head>
<body>

<h2><a id="h-1"></a>Backups to Maintain Sanity</h2>
<p><a href="https://github.com/Open-Advice/Open-Advice/blob/master/infrastructure/AustinAppel.tex" class="link">The original text</a> (licenced under CC-BY-SA)</p>
<p class="flushright">Austin Appel</p>
<div class="lead">
<p>Austin &quot;scorche&quot; Appelは情報セキュリティのプロで、これまで安全だと見なされていたものを（許可を得た上で）崩していくことに時間を割いている。セキュリティに関するカンファレンスなどでは、鍵のピッキングの方法を教えている姿をよく見かける。オープンソースの世界ではRockboxプロジェクトを運営しており、かつてはOne Laptop Per Childプロジェクトにも協力していた。</p>
</div>
<p class="noindent">「バックアップが大事」「バックアップこそがすべて」「デキる管理者は、いつだって最新のバックアップを持っている」サーバー管理のマニュアルには、たいていこんなことが書いてある。問題は、バックアップを実際に使うのは、本当に必要に迫られたときだけだということである。一大事が起こって、サーバーやデータの復旧を迫られたとしよう。バックアップがあれば助けになるだろう。しかし、そんな一大事が起こることは、まずない。それ以外の平穏無事なときにもバックアップを取っておくというのは、いったい何の意味があるのだろうか？</p>
<p>Before going further, it is important to note that the advice espoused is for the smaller open source project server administrators out there -- the silent majority. If you maintain services that would cause a large amount of frustration, and even perhaps harm if they experienced any downtime, please take this with a very small grain of salt.</p>
<p>For the rest of us who work with countless smaller projects with limited resources, we rarely have a separate test and production server. In fact, with all of the many services that an open source project typically needs to maintain (version control, web services, mailing lists, forums, build bots, databases, bug/feature trackers, etc.), separate testing environments are often the stuff we can only dream about. Unfortunately, the typical approach to system administration is to tread lightly and only upgrade the systems when absolutely necessary, to avoid risking dependency issues, broken code, or any of the other million things that could go wrong. The reason you are nervous is not because you may be inexperienced. It is important to know that you are not alone in this. Whether or not we admit it to others, many of us have been (and likely still are) in this position. The sad fact is that this inaction -- stemming from the fear of breaking a ``working'' system -- often leads to running services which are often several versions behind the curve, and come with a host of potentially serious security vulnerabilities. Rest assured that this is not the only way to play the game though.</p>
<p>People tend to play a game differently when they have infinite lives as compared to needing to start over from the start as soon as one mistake is made. Why should server administration be any different? Approaching the concept of backups with an offensive mindset can change your whole view of administrating systems. Instead of living in fear from a complete dist-upgrade (or equivalent command for yum, pacman, etc.), when armed with backups, one is free to update the packages on a server secure in the knowledge that the changes can always be rolled back if things turn sour. The key to getting over this is all about a state-of-mind. There is no reason to fear as long as you have your safety net of backed-up files beneath you as you jump. After all, system administration is constantly a learning experience.</p>
<p>Of course, if you do not validate your backups, relying on backups in this way becomes a very dangerous game.  Fortunately, experienced system administrators know that the commandment ``keep current backups'' is always followed by ``validate your backups.'' Again, this is another mantra that people like to recite.  What does not fit as elegantly into a catchy mantra is how quickly and easily validating backups can be accomplished. The best way to tell that a backup works is, of course, to restore it (preferably on an identical system not currently active). But again, in the absence of such luxuries, a bit more creativity is required. This is where (at least for files) checksums can help you determine the integrity of your backed-up files. In rsync, for example, the default method it uses to determine which files have been modified is to check the time of last modification and size of the file.  However, by using the “-c” option, rsync will use a 128-bit MD4 checksum to determine whether files have changed or not. While this may not always be the best idea to do every time in all situations due to likely taking much longer than a normal rsync and increased io usage, this ensures that the files are intact.</p>
<p>The role of system administrator can be a stressful one at times.  However, there is no need to make it more so than it needs to be.  With the proper frame of mind, some ostensibly single-purpose defense-seeming tasks can be used as valuable tools to allow you to nimbly move forward with your sanity intact with the speed appreciated by all open source projects.</p>
</body>
</html>
