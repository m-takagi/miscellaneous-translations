<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ops="http://www.idpf.org/2007/ops" xml:lang="ja">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <link rel="stylesheet" type="text/css" href="style.css" />
  <meta name="generator" content="ReVIEW" />
  <title>Backups to Maintain Sanity</title>
</head>
<body>

<h2><a id="h-1"></a>Backups to Maintain Sanity</h2>
<p><a href="https://github.com/Open-Advice/Open-Advice/blob/master/infrastructure/AustinAppel.tex" class="link">The original text</a> (licenced under CC-BY-SA)</p>
<p class="flushright">Austin Appel</p>
<div class="lead">
<p>Austin &quot;scorche&quot; Appelは情報セキュリティのプロで、これまで安全だと見なされていたものを（許可を得た上で）崩していくことに時間を割いている。セキュリティに関するカンファレンスなどでは、鍵のピッキングの方法を教えている姿をよく見かける。オープンソースの世界ではRockboxプロジェクトを運営しており、かつてはOne Laptop Per Childプロジェクトにも協力していた。</p>
</div>
<p class="noindent">「バックアップが大事」「バックアップこそがすべて」「デキる管理者は、いつだって最新のバックアップを持っている」サーバー管理のマニュアルには、たいていこんなことが書いてある。問題は、バックアップを実際に使うのは、本当に必要に迫られたときだけだということである。一大事が起こって、サーバーやデータの復旧を迫られたとしよう。バックアップがあれば助けになるだろう。しかし、そんな一大事が起こることは、まずない。それ以外の平穏無事なときにもバックアップを取っておくというのは、いったい何の意味があるのだろうか？</p>
<p>話を進める前にひとこと断っておくと、今回のアドバイスは小規模なオープンソースプロジェクトのサーバー管理者向けのもの、つまり、サイレントマジョリティ向けのものだ。いざダウンしてしまうと大勢の人をイライラさせてしまったり、それだけではなく傷つけてしまったりするようなサービスを管理しているという人は、話を割り引いて聞いて欲しい。</p>
<p>それ以外の多くの人たち、つまり、数え切れないほどの小規模プロジェクトで限られたリソースの中で管理者を務めている人たちにとって、本番環境とは別にテスト環境を用意できるなどということはめったにない。オープンソースプロジェクトで管理すべきサービスはいろいろある（バージョン管理システムやウェブページ、メーリングリスト、フォーラム、自動ビルド、データベース、バグ追跡など）が、それぞれにテスト環境を用意することなど夢のまた夢であることが多い。残念なことに、そんなシステムの管理といえば、必要に迫られるまではできるだけ手を付けずそっとしておくということが多い。依存関係を壊してしまったりコードを壊してしまったり、その他何かを間違えてしまうリスクが多すぎるからだ。そんなふうに神経質になってしまうのは、決してあなたの経験が浅いからではない。同じような仲間が他にもいることを知っておこう。認めると認めざるとに関わらず、私たちの多くはそんな経験をしてきた（そして今もそうであるという人も多い）。ただ、こんな風に何もしないでいる（「動いている」システムが壊れるのを怖がっている）と、深刻なセキュリティ問題を抱えたままでサービスを動かすことになってしまう。でも、それ以外にもやり方はある。</p>
<p>People tend to play a game differently when they have infinite lives as compared to needing to start over from the start as soon as one mistake is made. Why should server administration be any different? Approaching the concept of backups with an offensive mindset can change your whole view of administrating systems. Instead of living in fear from a complete dist-upgrade (or equivalent command for yum, pacman, etc.), when armed with backups, one is free to update the packages on a server secure in the knowledge that the changes can always be rolled back if things turn sour. The key to getting over this is all about a state-of-mind. There is no reason to fear as long as you have your safety net of backed-up files beneath you as you jump. After all, system administration is constantly a learning experience.</p>
<p>Of course, if you do not validate your backups, relying on backups in this way becomes a very dangerous game.  Fortunately, experienced system administrators know that the commandment ``keep current backups'' is always followed by ``validate your backups.'' Again, this is another mantra that people like to recite.  What does not fit as elegantly into a catchy mantra is how quickly and easily validating backups can be accomplished. The best way to tell that a backup works is, of course, to restore it (preferably on an identical system not currently active). But again, in the absence of such luxuries, a bit more creativity is required. This is where (at least for files) checksums can help you determine the integrity of your backed-up files. In rsync, for example, the default method it uses to determine which files have been modified is to check the time of last modification and size of the file.  However, by using the “-c” option, rsync will use a 128-bit MD4 checksum to determine whether files have changed or not. While this may not always be the best idea to do every time in all situations due to likely taking much longer than a normal rsync and increased io usage, this ensures that the files are intact.</p>
<p>The role of system administrator can be a stressful one at times.  However, there is no need to make it more so than it needs to be.  With the proper frame of mind, some ostensibly single-purpose defense-seeming tasks can be used as valuable tools to allow you to nimbly move forward with your sanity intact with the speed appreciated by all open source projects.</p>
</body>
</html>
