<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ops="http://www.idpf.org/2007/ops" xml:lang="ja">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <link rel="stylesheet" type="text/css" href="style.css" />
  <meta name="generator" content="Re:VIEW" />
  <title>Packaging - Providing a Great Route into Free Software</title>
</head>
<body>
<h1><a id="h"></a>Packaging - Providing a Great Route into Free Software</h1>
<p><a href="https://github.com/Open-Advice/Open-Advice/blob/master/packaging/ThomMay.tex" class="link">The original text</a> (licenced under CC-BY-SA)</p>
<p class="flushright">Thom May</p>
<div class="lead">
<p>Thom MayはDebian Developerで、Apache Software Foundationの名誉メンバーだ。また、Ubuntuの親会社であるCanonicalの創業メンバーの一員でもある。現在はロンドン在住で、Macmillan Digital ScienceでDevOps部隊を率いている。</p>
</div>

<h2><a id="h-1"></a>はじめに</h2>
<p>フリーソフトウェアの世界に関わるようになってから、既に十年以上が経過した。大学時代にDebianを使っていて、自分も何か恩返しをしたいと思ったのがきっかけだった。どいうわけで、最初はDebian新規メンテナプロセスに沿って進めるところから始まった。それまではフリーソフトウェアに貢献するなんて経験はなかったし、C言語のプログラミング経験がないのは大問題じゃないのかと心配していた。</p>
<p>後にわかったことだが、それはまったくの杞憂だった。私が常用していたパッケージに関する作業を始めたが、十分に貢献できた。Debianがメンテナに提供するツールやシステム群に慣れ親しむにつれて、私の経験も増し、時間をより効率的に使えるようになった。そして、より数多くのパッケージに関われるようになった。</p>
<p>より多くのパッケージに関わることで、いろいろなビルドシステムやプログラミング言語そしてツールキットを経験できた。そして、私がDebianコミュニティに加わる際の太助にもなった。気むずかしくて意地っ張りなところもあるが、優秀なメンテナが集まったDebianのコミュニティは、Debianが長期にわたって技術的な卓越を保ち続けている理由のひとつでもある。</p>
<p>Apache httpdプロジェクトがhttpd 2.0の最初のベータリリースを目前に控えたころのことを振り返る。数年がかりのリリースで、かなり大きなアップグレードになりそうだった。当時のDebianのApacheチームはあまり活発ではなく（1.3のパッケージは安定していたし、めったに変更が加わることがなかった）、2.0のパッケージングを作る予定は何もなかった。私は、httpdパッケージのメンテナンスが続くかどうかを気にかけていた。というのも、自分自身、システム管理者としてあちこちでApache Webサーバーを管理していたからだ。この新しいリリース用のパッケージの作成にチャレンジするのは、理にかなったことだった。</p>
<p>私は友人と作業を始めた。コード自体はベータ版の品質に達していたが、httpdのビルドやカスタマイズに関するツール群が決定的に欠けていることに気づいた。それは、複雑なソフトウェアプロジェクトでは、よくある光景だった。</p>
<p>ほぼ一年を費やして（その間、アップストリームはコードを安定化させ、アーリーアダプターたちは新しいリリースを試し始めるようになっていた）必死で作業をした結果、ビルドシステムは十分に柔軟で堅牢なものとなり、Debianの厳しいポリシーを満たすようになった。私たちのパッケージが技術的に正確であることを保証するだけではなく、アップストリームとの関係を良好にして、アップストリームへのパッチをすぐに反映させてもらえたり、セキュリティ問題や初期のリリース候補についての通知をもらえたりすることを示す必要もあった。</p>
<p>httpd 2.0のパッケージ作成やその保守に当たる上でのApacheとのやりとりを経て、私はアップストリームのコミッターになった。つまり、コアに直接貢献できるようになったというわけだ。ソフトウェアのパッケージングから実際のソフトウェア開発へと進むことで、自分たちのディストリビューションだけではなく、より幅広い人たちのために役立てるようになった。個人レベルでは、アップストリームのコミッターになったおかげで自信もつき、その他のフリーソフトウェアプロジェクトでの活動もやりやすくなった。自分のコードが、他に受け入れられるだけのものであることがわかったからだ。</p>

<h2><a id="h-2"></a>進化 - パッケージャーから開発者へ</h2>
<p>どういう経緯で、パッケージャーから開発者になったのかって？パッケージングとは、簡単に言うと、何らかのソフトウェアプロジェクトが、ディストリビューションのポリシーを満たすことを保証する作業だ。私の場合、そのディストリビューションはDebianだった。パッケージング作業は一般に、ソフトウェアのビルド時の設定から始まる。適切な場所（FHS：File Hierarchy Standardに沿った場所）にファイルが収まるようにしたり、他のパッケージとの依存関係を正しく指定したりして、対象のディストリビューション上でそのソフトウェアが正しく動くようにする。</p>
<p>より複雑なものになると、アップストリームのプロジェクトを複数のパッケージに分割することも必要になってくる。たとえば、開発者向けのライブラリやヘッダファイル群だけを個別のパッケージにしたり、プラットフォームに依存するファイルを、全プラットフォーム共通のファイルとは別のパッケージにしたりといった作業だ。こういった場合にアップストリームのソフトウェアを正しくデプロイできるようにするには、コードに手を加える必要が出てくることが多い。パッケージングは基本的に受け身の作業だが、このときのコードの変更は、プロジェクトに能動的に関わり始める第一歩になる。</p>
<p>ひとたびパッケージが何らかのディストリビューションで公開されると、そのパッケージは何百万もの潜在ユーザーに晒されることになる。ユーザーはきっと、パッケージャーであるあなたやアップストリームの開発者たちが思いもよらない方法で、そのソフトウェアを使おうとするだろう。いろんな人たちの目にとまることで、バグレポートの数も増える。他の多くのディストリビューションと同様に、Debianでも、バグレポートは（アップストリームではなく）Debianに直接送るよう推奨している。そうしておけば、メンテナがそのバグをトリアージして、パッケージングの際に加えた変更がそのバグの原因なのかどうかを判断できる。問題の報告者とパッケージのメンテナの間で十分なやりとりを繰り返してから、必要ならアップストリームの開発者にもそこに加わってもらう。</p>
<p>As the package maintainer increases their knowledge of the project, they will be able to solve most problems directly. The maintainer will often release bug fixes directly into Debian in parallel with feeding them back upstream, allowing for swift problem resolution and considerable testing of fixes. Once a fix is confirmed the maintainer will then work with the upstream project to ensure that the required changes happen in the upstream, definitive project, so that they are available to other users of the software.</p>
<p>Providing successful bug fixes on distributions such as Debian is often a complex art form. Debian runs on many platforms, from IBM mainframes to smart phones, and the range and breadth of these platform swiftly reveals assumptions in the code. More often than not the packager has easier access to a broader range of platforms than upstream does, and so is the first port of call when a knotty porting problem does come up. One quickly learns to recognise the symptoms of pointer size assumptions, endianness problems, and many other esoteric issues; this experience makes one a more versatile and cautious programmer.</p>
<p>As a package collects bug fixes and improvements, it is essential to feed those changes back upstream. Too often the delta between a package and the definitive, upstream software can grow enormously, with the effect that the two become almost entirely separate code bases. Not only does this increase the maintenance burden on both sides, but it can cause huge frustration and waste large amounts of time for your upstream should a user of your package report a bug related to one of the changes in the packaged version to the upstream. To this end, a close working relationship with upstream and an understanding of the best way for both parties to collaborate is vital.</p>
<p>Collaboration between upstream and packager can take many forms. Whether it be finding the correct way to communicate bug reports, making sure you use the correct coding style, or ensuring that you both use the same version control system in the same way, making sure that your interactions are as friction-free as possible, makes for a far better relationship with upstream and a greatly increased likelihood that your upstream will take the time to help you when you need it.</p>
<p>Once the working relationship between you and your upstream is established, it becomes an easy step to contribute more directly to upstream. This, too, can take many forms. Simple first steps can involve synchronising any upstream bug reports with the ones from your distribution, making sure that duplicate effort is not expended to root cause and fix bugs. More direct involvement entails feature development and changes with a wider scope than would be palatable when made in a packaged version.</p>

<h2><a id="h-3"></a>Conclusion</h2>
<p>I think the two core things I wish I had known when starting out are the sense of community that Free Software engenders, and the fantastic route that packaging of Free Software provides into the wider Free Software world.</p>
<p>Community is critical to the success of Free Software. It comes in many forms, from the legion of users willing to invest time in making your software better, to one’s peers in a distribution or software project who invest their time and energy into honing your skills and ensuring that your contributions are as good as possible.</p>
<p>The route from packaging into development is one often traveled. It provides a learning curve less steep than entering a development community cold, and allows one to develop skills at a more gradual rate than would otherwise be the case.</p>
</body>
</html>
